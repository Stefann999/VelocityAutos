@using VelocityAutos.Services.Data.Interfaces
@using VelocityAutos.Web.Infrastructure.Extensions
@model IEnumerable<CarAllViewModel>

@inject ICarService CarService

<head>
    <title>All cars</title>
    <link rel="stylesheet" href="~/css/allCars.css" />
</head>

<div class="header">
    <h1>Car Showcase</h1>
</div>

<div class="car-container">

@foreach (var car in Model)
{
    bool isUserOwner = await CarService.IsUserCarOwnerById(car.Id, User.GetId()!);
      <div class="car">
          <img src="@car.ImagesPaths.FirstOrDefault()" alt="@car.Make">
          <div class="car-info">
              <div class="car-title">@car.Make</div>
              <div class="car-description">@car.Model</div>
          </div>
            @if (User.Identity.Name == car.OwnerId)
            {
                <a asp-controller="Event" asp-action="Details" asp-route-id="@e.Id" class="btn btn-warning mb-2 w-100 p-3 fw-bold">View Details</a>
                <a asp-controller="Event" asp-action="Edit" asp-route-id="@e.Id" class="btn btn-warning mb-2 w-100 p-3 fw-bold">Edit</a>
            }
            else
            {
                <form class="input-group-sm " asp-controller="Event" asp-action="Leave" asp-route-id="@e.Id">
                    <input type="submit" value="Leave the Event" class="fs-6 btn btn-warning mb-3 w-100 p-3 fw-bold" />
                </form>
                <a asp-controller="Event" asp-action="Details" asp-route-id="@e.Id" class="btn btn-warning mb-2 w-100 p-3 fw-bold">View Details</a>
            }
      </div>
}

</div>